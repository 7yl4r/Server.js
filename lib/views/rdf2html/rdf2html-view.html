<!-- Requirements, this _should_ be in the header -->
<script type="text/javascript" src="/assets/rdf2html.js"></script>
<link rel="stylesheet" href="/assets/rdf2html.css" />
<link rel="stylesheet" href="/assets/leaflet.css" />

<!-- Panels with human-readable content -->
<div class="panel-body" data-rdftohtml-plugin='triples'></div>

<div class='map' data-rdftohtml-plugin='map'></div>

<div data-rdftohtml-plugin='paging'></div>
<div data-rdftohtml-plugin='tpfcollector'></div>

<!-- The actual triples in Turtle -->
<script id="turtle" type="text/turtle">
<%- serializedtriples %>
</script>

<!-- Run RDF2HTML -->
<script type="text/javascript">
    var triples = document.getElementById("turtle").innerHTML;
    var config = {
        // Plugins to be called
        plugins: {
            paging: true,
            tpfcollector: {
                callback: function(db, container, prefixes, config) {
                    var uri = document.location.href.match(/(^[^#]*)/)[0];
                    var baseUri = document.location.href.match(/(^[^#?]*)/)[0];
                    db.removeTriples(db.find(uri, null, null));
                    db.removeTriples(db.find(baseUri, null, null));
                    db.removeTriples(db.find(null, null, uri));
                    db.removeTriples(db.find(null, null, baseUri));
                }
            },
            triples: true,
            map: {
                // Base path on which the assets are provided
                assetsBase: '/assets'
            }
        },
        // Output information to the console, errors are always logged to the console
        verbose: true
    };
    rdf2html(triples, config);
</script>
